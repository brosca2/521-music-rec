# Music Recommendation System

## Project Overview

This system provides music recommendations based on quantitative analysis of audio features. Given a directory of audio tracks in WAV format, it identifies and ranks songs acoustically similar to each track within the collection. The system processes audio files, extracts a comprehensive set of acoustic features, scales these features for equitable comparison, calculates pairwise similarity using a standard metric, and presents the top recommendations for each input track.

## Methodology


1.  **Audio Loading:** Each WAV audio file in the specified directory is loaded using the `librosa` library. This provides access to the raw audio time series data and sample rate necessary for feature extraction.

2.  **Feature Extraction:** A set of 31 acoustic features is extracted from each track, again utilizing `librosa`. These features are selected to represent diverse aspects of the audio signal relevant to musical similarity perception:
    *   **Rhythm/Tempo:**
        *   *Tempo:* Estimated global tempo in Beats Per Minute (BPM).
        *   *Beat Regularity:* Standard deviation of the time intervals between detected beats, indicating rhythmic consistency.
    *   **Timbre/Texture:**
        *   *Mel-Frequency Cepstral Coefficients (MFCCs):* The mean values of the first 13 MFCCs are computed. MFCCs are widely used in audio processing as they effectively represent the timbral quality or sonic texture of a sound, modeling the human auditory system's response.
        *   *Spectral Centroid:* The mean value indicates the "center of mass" of the spectrum, correlating with the perceived brightness of the sound.
        *   *Spectral Bandwidth:* The mean value measures the width of the frequency band around the spectral centroid.
        *   *Zero-Crossing Rate (ZCR):* The mean rate at which the audio signal crosses the zero amplitude level, often related to the noisiness or percussive content of the signal.
    *   **Harmony/Pitch:**
        *   *Chroma Features:* The mean values across 12 distinct pitch classes (semitones) are calculated. Chroma features represent the distribution of harmonic energy within the track, useful for capturing melodic and harmonic content.
    *   **Loudness:**
        *   *Root Mean Square (RMS) Energy:* The mean RMS value provides an indication of the track's overall perceived loudness.


3.  **Feature Scaling:** To make sure that all features contribute appropriately to the similarity calculation, regardless of their inherent numerical ranges, the extracted feature vectors are scaled. A  min-max scaler is applied to transform all feature values to a uniform range of [0, 1]. This prevents features with larger absolute values (e.g., spectral centroid) from dominating the similarity metric over features with smaller values (e.g., ZCR).

4.  **Similarity Calculation:** Within `similarity_calculator.py`, the pairwise acoustic similarity between tracks is determined using cosine similarity. This metric is applied to the scaled feature vectors generated by `feature_extractor.py` and processed in `main.py`. Specifically, the scaled feature vector of a target track is compared against the vectors of all other tracks in the collection. Cosine similarity tracks based on the *profile* of acoustic characteristics rather than their absolute magnitudes. This approach is robust to overall loudness differences. Furthermore, the system applies non-equivalent weights to different features, which prioritizes specific acoustic dimensions (like emphasizing rhythmic features over timbral ones) if desired. However, the current default configuration applies equal weighting across all extracted features. This was a specific problem- since not all measurements are equal, and thus, some were the dominating feature that would end up causing a completely unrelated track to be ranked higher than the intended ones (like artist's songs from the same album).
5.  **Recommendation Ranking:** For each track processed (acting as the "target" track), the system identifies the other tracks in the dataset with the highest cosine similarity scores relative to the target. These scores are sorted in descending order, and the top 5 tracks are presented as the most likely to be recommended in a production-level algorithm.

## File Structure

*   `feature_extractor.py`: Contains the functions for extracting the 31 acoustic features from WAV files using `librosa`.
*   `similarity_calculator.py`: Only contains cosine similarity
*   `main.py`: Main.py. That's what it is. Just kidding: It locates WAV files, manages parallel feature extraction (since 1 by 1 was slow), performs feature scaling, and runs the similarity calculation for each track, printing the top 5 recommendations per track.
*   `convert_mp3_to_wav.py`: Utility script to convert MP3 audio files to the required WAV format (optional pre-processing step)-- this isn't as useful anymore, because all songs are already in .WAV. I just kept it.
*   `requirements.txt`: Specifies the necessary Python dependencies (`librosa`, `numpy`, `scikit-learn`).
*   `wav_songs/`: Contains the input WAV audio files for analysis- this will be added to the repo on submission, since it's quite a big playlist. `TODO: submit a Drive/ Box link to the songs that I used-- they were my playlist`

## Setup

1. **Install Dependencies:** Install the required Python packages using pip:
    ```bash
    pip install -r requirements.txt
    ```
2.  **Prepare Audio Files:** Place the WAV audio files you wish to analyze into the `wav_songs/` directory (or specify a different directory via the command-line argument). If your files are in MP3 format (probably unlikely), use the `convert_mp3_to_wav.py` script first. 

## Usage

1.  **Run Analysis:** Execute the main script, providing the path to the directory containing your WAV files.
    ```bash
    python main.py --songs_dir wav_songs/
    ```
    Replace `wav_songs/` if your WAV files are located in a different directory.

2.  **Output:** The script will process all WAV files found in the specified directory. For each song, it will print a list of the top 5 most acoustically similar songs found within that same directory, along with their respective cosine similarity scores (as a percentage).

## Note on Filenames

The example WAV files included may contain prefixes (e.g., `[SPOTDOWNLOADER.COM]`). I trimmed them, but that was only because my source of song .MP3 files was from SPOTDOWNLOADER.COM. All rights reserved (I think?)
